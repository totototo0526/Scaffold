# プロジェクト概要書：HMS画面実装自動化ツール

## 1. プロジェクトの目的とゴール

### 目的
本プロジェクトの目的は、HMS（販売管理アプリケーション）の新規画面開発における生産性を飛躍的に向上させるための社内向けWebツールを開発することである。

現在のHMSの開発プロセスでは、UIの定義情報を`m_hanyo`や`m_content`テーブルへ手動で登録する作業が大部分を占める。特に、「どのDBカラムを、画面のどこで、どのように使うか」を決定する設計フェーズは思考コストが高く、その後のデータ登録作業は単純だが手間がかかる。

このツールは、これらの「設計」と「製造」のプロセスを支援・自動化する。

### ゴール
-   画面の仕様（使用するDBカラム、UIの種類など）をGUI上で直感的に定義できること。
-   定義された仕様を元に、`m_hanyo`, `m_content`へ登録するための**SQLスクリプト**を自動生成すること。（ポスグレの関数で実現）
-   画面固有のビジネスロジックを記述するための**PostgreSQL関数の雛形（スタブ）**を自動生成すること。（ポスグレの関数で実現）
-   これにより、開発者は画面固有のビジネスロジックの実装に集中できる状態を作り出す。

---

## 2. 生成対象のアプリケーションアーキテクチャ

本ツールが生成するコードとデータは、以下のHMSアーキテクチャに基づいている。

-   **UI定義**: `m_hanyo`テーブル
    -   `mst_kbn`という区分を使い分け、コントローラー(`CB`)、ページレイアウト(`CC`)、フォーム(`C1`/`C2`)、一覧(`C3`)、アクション(`CD`)といったUI部品を定義する。
-   **ページ情報**: `m_content`テーブル
    -   ナビゲーションメニューやパンくずリストなど、ページの周辺情報を定義する。
-   **ビジネスロジック**: PostgreSQL関数
    -   画面固有のデータ取得、更新、削除、および複雑なビジネスルールは、DB関数内にカプセル化される。

---

## 3. 開発するツールの技術スタック

-   **フロントエンド**: SvelteKit
-   **言語**: TypeScript
-   **API層**: n8n (PostgreSQL関数を呼び出すためのシンプルなAPIゲートウェイとして)
-   **データベース**: PostgreSQL
    -   アプリケーションの定義情報（`m_hanyo`, `m_content`）の読み書き。
    -   ツール自体の設定ルール（`generator_components`テーブルなど）の保存。

---

## 4. ツールの基本操作フロー

ツールは、アプリケーション全体の構造を管理する「ダッシュボード」と、個別の画面を定義する「ウィザード」の2つの主要な画面で構成される。

1.  **ダッシュボード**:
    -   `m_content`の情報を元に、アプリケーション全体のメニュー構造をツリー形式で表示する。
    -   ツリーから画面を選択すると、その画面のUI定義の充足状況（C1, C3などが作成済みか）を確認できる。
2.  **画面定義ウィザード**:
    -   ダッシュボードから特定の画面を選択し、「定義を編集」を押すとウィザードが起動する。
    -   ウィザードに従い、「基本情報」「項目定義」「アクション選択」を入力することで、必要なSQLと関数雛形が自動生成される。