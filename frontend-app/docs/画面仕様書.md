# 画面仕様書：HMS画面実装自動化ツール

## 1. 概要
本ツールは、大きく分けて「ダッシュボード画面」と、そこから呼び出される「画面定義ウィザード」の2つの画面で構成される。

---
## 2. 画面詳細

### 2.1. ダッシュボード画面
**目的**: アプリケーション全体の画面構成を俯瞰し、編集対象の画面を選択する。

**主要なUI要素**:
-   **メニューツリー (左ペイン)**
    -   `m_content`テーブルの親子関係を元にしたツリービューを表示する。
    -   ツリーの各項目（ノード）は、追加、編集（名称変更）、削除、階層移動が可能であること。
-   **画面ステータス (右ペイン)**
    -   ツリーで選択された画面のメタ情報を表示する。
        -   `画面表示名`
        -   `URL識別子`
        -   `DBテーブル名`
    -   その画面のUI定義の充足状況を一覧で表示する。
        -   `一覧定義 (C3)`: [作成済み ✅ / 未作成 ❌]
        -   `詳細/検索定義 (C1/C2)`: [作成済み ✅ / 未作成 ❌]
        -   `アクション定義 (CD)`: [作成済み ✅ / 未作成 ❌]
    -   **[⚙️ この画面の定義を編集する] ボタン**: クリックすると、選択中の画面情報を引き継いで「画面定義ウィザード」を起動する。

### 2.2. 画面定義ウィザード
**目的**: ユーザーからの入力を元に、画面を構成するためのSQLと関数雛形を生成する。ウィザードは4つのステップで構成される。

#### ステップ1：基本情報
-   **UI要素**:
    -   `画面表示名`: テキスト入力
    -   `URL識別子`: テキスト入力
    -   `DBテーブル名`: テキスト入力
    -   `主キーカラム`: ドロップダウン選択
    -   `レイアウト種別`: ドロップダウン選択 (`Flat` / `Tab`)
-   **動作**:
    -   既存画面の編集時は、これらの値がDBから読み込まれ、入力済みの状態で表示される。
    -   「DBテーブル名」が入力されると、そのテーブルのカラム一覧が取得され、ステップ2の「DBカラム名」ドロップダウンの選択肢となる。

#### ステップ2：項目定義
-   **UI要素**:
    -   **項目定義グリッド**:
        -   画面で利用する項目を定義するメインのUI。
        -   グリッドの列: `DBカラム名` (ドロップダウン), `表示名` (テキスト入力), `UIタイプ` (ドロップダウン), `一覧(C3)` (チェックボックス), `検索(C2)` (チェックボックス), `フォーム(C1)` (チェックボックス), `詳細設定` (ボタン)。
    -   **[+ 項目を追加] ボタン**: グリッドに新しい空の行を追加する。
-   **詳細設定モーダル**:
    -   グリッド各行の `詳細設定` ボタン (⚙️) をクリックすると表示されるポップアップウィンドウ。
    -   **フォーム項目 (`C1`/`C2`) の設定**: `読み取り専用`, `主キーフラグ`, `ドロップダウンmst_kbn`, `ルックアップID`などを設定する。
    -   **一覧項目 (`C3`) の設定**: `リンク化設定`（キーにするカラム名）などを設定する。

#### ステップ3：アクションの選択と最終確認
-   **UI要素**:
    -   **アクション選択**: `[ ] 新規作成`, `[ ] 編集`, `[ ] 削除` のチェックボックス。
    -   **確認エリア**: ステップ1, 2で入力した内容の最終確認サマリーを表示する。

#### ステップ4：生成結果
-   **UI要素**:
    -   **タブ**: `m_hanyo.sql`, `m_content.sql`, `functions.sql` の3つのタブ。
    -   各タブ内には、生成されたSQLスクリプトまたは関数雛形が表示されるテキストエリアと、`[クリップボードにコピー]` ボタンを配置する。